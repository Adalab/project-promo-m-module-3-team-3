"use strict";const savedData=JSON.parse(localStorage.getItem("data"));let data={name:"",job:"",photo:"",email:"",phone:"",linkedin:"",github:"",palette:""};const icon1=document.querySelector(".js-icon1"),icon2=document.querySelector(".js-icon2"),icon3=document.querySelector(".js-icon3"),icon4=document.querySelector(".js-icon4");let nameInput=document.querySelector("#name"),jobInput=document.querySelector("#job"),emailInput=document.querySelector("#email"),phoneInput=document.querySelector("#phone"),linkedinInput=document.querySelector("#linkedin"),githubInput=document.querySelector("#github"),paletteElements=document.querySelectorAll(".js_palette"),card={line:document.querySelector(".rectangle"),title:document.querySelector(".name"),border:document.querySelectorAll(".icon"),icon:document.querySelectorAll(".iconcolor"),job:document.querySelector(".job"),phone:document.querySelector(".js-phone"),email:document.querySelector(".js-email"),linkedin:document.querySelector(".js-linkedin"),github:document.querySelector(".js-github"),image:document.querySelector(".js__profile-preview")};function getLocalStorage(){null!==data&&(nameInput.value=savedData.name,jobInput.value=savedData.job,emailInput.value=savedData.email,phoneInput.value=savedData.phone,linkedinInput.value=savedData.linkedin,githubInput.value=savedData.github),localStorageColor()}null!==localStorage.getItem("data")&&getLocalStorage(),savedData&&(data=savedData,inputChange(),localStorageColor(savedData));const cdesign=document.querySelector(".js-cdesign"),cfill=document.querySelector(".js-cfill"),cshare=document.querySelector(".js-cshare"),contentDesign=document.querySelector(".js-design"),contentFill=document.querySelector(".js-fill"),contentShare=document.querySelector(".js-share"),arrowDesign=document.querySelector(".js-arrowD"),arrowFill=document.querySelector(".js-arrowF"),arrowShare=document.querySelector(".js-arrowS");function hiddenDesign(){contentDesign.classList.add("hidden")}function hiddenFill(){contentFill.classList.remove("hidden"),arrowFill.classList.remove("arrowhidden"),arrowFill.classList.add("collapsible__icon2")}function hiddenShare(){contentShare.classList.remove("hidden"),arrowShare.classList.remove("arrowhidden"),arrowShare.classList.add("collapsible__icon2")}function showDesign(){hiddenDesign(),contentDesign.classList.contains("js-design")&&(contentFill.classList.add("hidden"),contentShare.classList.add("hidden"),contentDesign.classList.remove("hidden"),arrowFill.classList.add("arrowhidden"),arrowShare.classList.add("arrowhidden"),arrowDesign.classList.remove("arrowhidden"))}function showFill(){hiddenFill(),contentFill.classList.contains("js-fill")&&(contentDesign.classList.add("hidden"),contentShare.classList.add("hidden"),arrowDesign.classList.add("arrowhidden"),arrowShare.classList.add("arrowhidden"))}function showShare(){hiddenShare(),contentShare.classList.contains("js-share")&&(contentDesign.classList.add("hidden"),contentFill.classList.add("hidden"),arrowDesign.classList.add("arrowhidden"),arrowFill.classList.add("arrowhidden"))}console.log(arrowShare),contentFill.classList.add("hidden"),contentShare.classList.add("hidden"),arrowFill.classList.remove("collapsible__icon2"),arrowShare.classList.remove("collapsible__icon2"),arrowFill.classList.add("arrowhidden"),arrowShare.classList.add("arrowhidden"),console.log(arrowShare),cdesign.addEventListener("click",showDesign),cfill.addEventListener("click",showFill),cshare.addEventListener("click",showShare);const palette1=document.querySelector(".palette-1"),palette2=document.querySelector(".palette-2"),palette3=document.querySelector(".palette-3"),label1=document.querySelector(".label1 input"),label2=document.querySelector(".label2 input"),label3=document.querySelector(".label3 input");function labelpalette1(){card.line.classList.add("js-color2"),card.line.classList.remove("js-color5","js-color8"),card.title.classList.add("js-color1"),card.title.classList.remove("js-color4","js-color7"),card.border.forEach(e=>e.classList.add("js-color3")),card.border.forEach(e=>e.classList.remove("js-color6","js-color9")),card.icon.forEach(e=>e.classList.add("js-color1")),card.icon.forEach(e=>e.classList.remove("js-color4","js-color7")),data.palette="1"}function labelpalette2(){card.line.classList.add("js-color5"),card.line.classList.remove("js-color2","js-color8"),card.title.classList.add("js-color4"),card.title.classList.remove("js-color1","js-color7"),card.border.forEach(e=>e.classList.add("js-color6")),card.border.forEach(e=>e.classList.remove("js-color3","js-color9")),card.icon.forEach(e=>e.classList.add("js-color4")),card.icon.forEach(e=>e.classList.remove("js-color1","js-color7")),data.palette="2"}function labelpalette3(){card.line.classList.add("js-color8"),card.line.classList.remove("js-color2","js-color5"),card.title.classList.add("js-color7"),card.title.classList.remove("js-color1","js-color4"),card.border.forEach(e=>e.classList.add("js-color9")),card.border.forEach(e=>e.classList.remove("js-color6","js-color3")),card.icon.forEach(e=>e.classList.add("js-color7")),card.icon.forEach(e=>e.classList.remove("js-color1","js-color4")),data.palette="3"}function localStorageColor(e){"1"===e&&(labelpalette1(),label1.setAttribute("checked","")),"2"===e&&(labelpalette2(),label2.setAttribute("checked","")),"3"===e&&(labelpalette3(),label3.setAttribute("checked",""))}label2.addEventListener("change",labelpalette2),label1.addEventListener("change",labelpalette1),label3.addEventListener("change",labelpalette3);const form=document.querySelector(".js-form"),reset=document.querySelector(".button_reset");function changeTitle(e){const t=e.target.name,a=e.target.value;data[t]=a}function inputChange(){card.title.innerHTML=""===data.name?"Nombre y Apellidos":data.name,card.job.innerHTML=""===data.job?"Puesto":data.job,card.email.href="mailto: "+data.email,card.phone.href="tel: "+data.phone,card.linkedin.href="https://linkedin.com/in/"+data.linkedin,card.github.href="https://github.com/"+data.github,""!==data.phone&&icon1.classList.remove("opacity"),""!==data.email&&icon2.classList.remove("opacity"),""!==data.linkedin&&icon3.classList.remove("opacity"),""!==data.github&&icon4.classList.remove("opacity")}function handlerKey(e){changeTitle(e),inputChange()}function validateEmail(e){return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function validatePhone(e){return/^([9,8,7,6]{1})+([0-9]{8})$/.test(e)}form.addEventListener("keyup",handlerKey);let photo="";const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview"),localImage=localStorage.getItem("photo");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result,localStorage.setItem("photo",data.photo)}localImage&&(profileImage.style.backgroundImage=`url(${localImage})`,profilePreview.style.backgroundImage=`url(${localImage})`,data.photo=localImage),fileField.addEventListener("change",getImage);const createCard=document.querySelector(".js-createcard"),responseElement=document.querySelector(".js-response"),btnTwitter=document.querySelector(".js-twitter"),linkTwitter=document.querySelector(".js-linkTwitter");function handlerClickCreate(e){e.preventDefault(),""===data.name?(responseElement.innerHTML="Oops! Tienes que rellenar tu nombre!",responseElement.classList.remove("hidden")):""===data.job?(responseElement.innerHTML="Oops! Tienes que rellenar tu puesto de trabajo!",responseElement.classList.remove("hidden")):""===data.photo?(responseElement.innerHTML="Oops! Tienes que subir tu foto!",responseElement.classList.remove("hidden")):""===data.email?(responseElement.innerHTML="Oops! Tienes que rellenar tu email!",responseElement.classList.remove("hidden")):validateEmail(data.email)?""===data.phone?(responseElement.innerHTML="Oops! Tienes que rellenar tu tel√©fono!",responseElement.classList.remove("hidden")):validatePhone(data.phone)?""===data.linkedin?(responseElement.innerHTML="Oops! Tienes que rellenar tu usuario de LinkedIn!",responseElement.classList.remove("hidden")):""===data.github?(responseElement.innerHTML="Oops! Tienes que rellenar tu usuario de GitHub!",responseElement.classList.remove("hidden")):(console.log(data),fetch("https://awesome-profile-cards.herokuapp.com/card",{method:"POST",headers:{"content-type":"application/json"},mode:"cors",body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{if(!1===e.success)responseElement.innerHTML="<p>Tienes que rellenar algunos datos.</p>",responseElement.classList.remove("hidden");else{const t="Echa un vistazo a mi tarjeta de visita üå± ";responseElement.innerHTML=`\n            <h3 class="cardcreated-js">La tarjeta ha sido creada:</h3>\n            <p><a class="linkcard" target:_blank href="${e.cardURL}">${e.cardURL}</a></p>`,responseElement.classList.remove("hidden"),btnTwitter.classList.remove("hidden"),linkTwitter.setAttribute("href",`https://twitter.com/intent/tweet?text=${t}&url=${e.cardURL}&hashtags=Adalabers,JavaScript,PromoMileva,week7of12`),createCard.setAttribute("disabled",!0),createCard.style.opacity="0.5",localStorage.setItem("data",JSON.stringify(data))}}).catch(()=>{responseElement.innerHTML='<p class="error">Hemos apagado el servidor un rato. Int√©ntalo m√°s tarde.</p>',responseElement.classList.remove("hidden")})):(responseElement.innerHTML="Oops! no has puesto bien el n√∫mero =(",responseElement.classList.remove("hidden")):(responseElement.innerHTML="Oops! no has puesto bien el email =(",responseElement.classList.remove("hidden"))}createCard.addEventListener("click",handlerClickCreate);const resetElement=document.querySelector(".button_reset"),paletteDefault=document.querySelector("#blue");function resetButton(e){e.preventDefault();for(const e of form)e.value="",profileImage.style="",profilePreview.style="",labelpalette1(),paletteDefault.checked=!0,data.palette="1",data.name="",data.job="",data.email="",data.phone="",data.linkedin="",data.github="",card.title.innerHTML="Mileva Mariƒá",card.job.innerHTML="Matem√°tica",card.phone.href="",card.email.href="",card.linkedin.href="",card.github.href="",""===data.phone&&icon1.classList.add("opacity"),""===data.email&&icon2.classList.add("opacity"),""===data.linkedin&&icon3.classList.add("opacity"),""===data.github&&icon4.classList.add("opacity");localStorage.clear()}resetElement.addEventListener("click",resetButton);